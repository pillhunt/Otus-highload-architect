# Корпоративный мессенджер

## Нефункциональные требования

- Быстрый поиск по контактам;
- Быстрое обновление доступных для всех контактов;
- Быстрая загрузка сообщений из чатов;
- Поддержка чатов с большим количеством участников;
- Устойчивое соединение для участников мероприятия.
## Функциональные требования

- Пользователь должен иметь возможность:
	- Просматривать список сообщений в чате, к которому есть доступ;
	- Создавать чат;
	- Приглашать в чат доступные контакты;
	- Работать с файлами:
		- скачивать;
		- загружать;
	- Формировать собственный список контактов;
	- Производить поиск по сообщениям, контактам, файлам;
	- Прикреплять к сообщению ссылку на документ из КЭДО;
	- Получать оповещения о новых событиях в чатах;
	- Отправлять и отслеживать тикет в случае сбоя;
	- Запланировать событие;
- Сотрудник тех. поддержки должен иметь возможность:
	- Работать с тикетами:
		- Создать чат с пользователем по тикету;
		- Производить поиск по тикетам, сообщениям, контактам, названиям файлов.
		- Изменять статус тикета.
	- Получать оповещения о новых тикетах;
## Ядерные сущности

- Пользователь
- Право
- Уведомление
- Тикет
- Чат
- Сообщение
- Файл
- Ссылка на документ
- Событие

![](./images/Pasted%20image%2020241013094459.png)

## API

### Авторизация

POST: /v1/auth
### Пользователи

GET: /v1/user/{userId} 
Ответ: 200 + Данные о пользователе, 400, 404 500

GET: /v1/user/{userId}/contactList 
Ответ: 200 + Список пользователей, 400, 404, 500

PUT: /v1/user/{userId} 
Тело запроса:
{
	info
	status
}
Ответ: 200, 400, 404, 500
### Чаты

GET: /v1/user/{userId}/channels\
Ответ: 200 + Список чатов, 400, 404, 500

POST: /v1/user/{userId}/channel
Тело запроса
{
	nameof
	user
	contacts
	status
}
Ответ: 200, 400, 404, 500

PUT: /v1/user/{userId}/channel/{channelId}
Тело запроса
{
	nameof
	contacts
	status
}
Ответ: 200, 400, 404, 500

GET: /v1/user/{userId}/channel/{channelId}\
Ответ: 200 + Список сообщений, 400, 404, 500
### Тикеты

GET: /v1/user/{userId}/ticket
Ответ: 200 + Список чатов, 400, 404, 500

POST: /v1/user/{userId}/ticket
Тело запроса
{
	tiketid
	userid
	status
	comment
}
Ответ: 200, 400, 404, 500
### Поиск

## High-level дизайн системы

### Отправка и получение сообщения

![](./images/Pasted%20image%2020241014201208.png)

Сервис управления сообщениями и чатами делает событие о создании сообщения или чата для Сервиса уведомлений. Сервис уведомлений делает опрос "кто получатель из списка {id, id, id, ...}?". По ответу отправляет уведомление о сообщении {id}.

### Поиск по сообщениям, файлам, контактам

![](./images/Pasted%20image%2020241014200725.png)
### Работа с тикетами

![](./images/Pasted%20image%2020241014200747.png)

### Масштабирование
